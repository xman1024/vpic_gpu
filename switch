#!/bin/bash -l

export lrank=$OMPI_COMM_WORLD_LOCAL_RANK

export APP=./lpi_head_single_new_diag.Linux

case ${lrank} in
[0])
  export CUDA_VISIBLE_DEVICES=0
  $APP
  ;;
[1])
  export CUDA_VISIBLE_DEVICES=1
  $APP
  ;;
[2])
  export CUDA_VISIBLE_DEVICES=2
  $APP
  ;;
[3])
  export CUDA_VISIBLE_DEVICES=3
  $APP
  ;;
[4])
  export CUDA_VISIBLE_DEVICES=0
  $APP
  ;;
[5])
  export CUDA_VISIBLE_DEVICES=1
  $APP
  ;;
[6])
  export CUDA_VISIBLE_DEVICES=2
  $APP
  ;;
[7])
  export CUDA_VISIBLE_DEVICES=3
  $APP
  ;;
[8])
  export CUDA_VISIBLE_DEVICES=0
  $APP
  ;;
[9])
  export CUDA_VISIBLE_DEVICES=1
  $APP
  ;;
[10])
  export CUDA_VISIBLE_DEVICES=2
  $APP
  ;;
[11])
  export CUDA_VISIBLE_DEVICES=3
  $APP
  ;;
[12])
  export CUDA_VISIBLE_DEVICES=0
  $APP
  ;;
[13])
  export CUDA_VISIBLE_DEVICES=1
  $APP
  ;;
[14])
  export CUDA_VISIBLE_DEVICES=2
  $APP
  ;;
[15])
  export CUDA_VISIBLE_DEVICES=3
  $APP
  ;;
esac

